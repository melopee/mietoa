<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>tỏaq mỉetōa</title>
  <link rel="stylesheet" type="text/css" href="./dic.css">
  <script src="./toaq_dict.js"></script>
  <script>
    function cz(b) {
      this.val = b;
      this.mut = function() { return this.val = !this.val }
      this.getval = function() { return this.val }
    }
    var toaqcz = new cz(true);
    var desccz = new cz(true);
    var gloscz = new cz(false);
    var typecz = new cz(false);
    function undiak(toa) {
      return toa.replace(/[áàâāãǎả]/g,"a").replace(/[éèêēẽěẻ]/g,"e").replace(/[íìîīĩǐỉ]/g,"i").replace(/[óòôōõǒỏ]/g,"o").replace(/[úùûūũǔủ]/g,"u")
    }
    function search() {
      nitoa = document.getElementById("nitoa");
      var toa = nitoa.value.toLowerCase();
      //var toaqcz = document.getElementById("toaq").checked;
      var kuaq = ""
      if (toa) {
        toa=undiak(toa);
        for (i in data) {
          if ((toaqcz.getval() && (data[i].toaq_undia.indexOf(toa)+1)) || (gloscz.getval() && (data[i].g_en.indexOf(toa)+1)) || (desccz.getval() && (data[i].d_en.indexOf(toa)+1)) || (typecz.getval() && (data[i].t_en.indexOf(toa)+1))) {
            kuaq += "<tr><td>" + data[i].toaq + "</td><td>" + data[i].t_en + "</td></tr><tr><td>" + data[i].d_en + "</td></tr>";
          }
        }
      } else {
        kuaq += "<tr><td>Empty search!</td></tr>";
      }
      if (!(toaqcz.getval() || desccz.getval() || typecz.getval() || gloscz.getval())) { // display the whole dictionary if no options
        kuaq = "" // needed since the else clause add "Empty search!" to the datnyvei called 'kuaq', which mess up css
        for (i in data) {
          kuaq += "<tr><td>" + data[i].toaq + "</td><td>" + data[i].t_en+ "</td></tr><tr><td>" + data[i].d_en + "</td></tr>";
        }
      }
      document.getElementById("gosho").innerHTML = kuaq
      nitoa.focus();
    }
    window.onload = function() {
      nitoa = document.getElementById("nitoa");
      nitoa.onkeyup = search; // when an option is changed, it is necessary to re-trigger the keyup event to update the resulting list
      nitoa.focus();
    }
  </script>
</head>
<body>
  <fieldset>
    <form>
      <span class="check"><span class="out"><input type="checkbox" id="toaq" onclick="search();toaqcz.mut();" value="toaq" checked><span class="in"></span></span><label>toaq</label></span>
      <span class="check"><span class="out"><input type="checkbox" id="desc" onclick="search();desccz.mut();" value="desc" checked><span class="in"></span></span><label>english</label></span>
      <span class="check"><span class="out"><input type="checkbox" id="type" onclick="search();typecz.mut();" value="type"><span class="in"></span></span><label>type</label></span>
      <span class="check"><span class="out"><input type="checkbox" id="glos" onclick="search();gloscz.mut();" value="glos"><span class="in"></span></span><label>gloss</label></span>
    </form>
  </fieldset>
<div id="tuai">
  <input id="nitoa" type="text" placeholder="" size="14" />
  <br /><br />
  <table id="gosho"></table>
  <noscript>Your browser does not support JavaScript, which is required to make this dictionary works.</noscript>
</div>
</body>
</html>
